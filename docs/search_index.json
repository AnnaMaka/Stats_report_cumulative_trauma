[["index.html", "Data Preparation and Analysis 1 Overview 1.1 Introduction", " Data Preparation and Analysis Anna Makova 10/01/2022 1 Overview This is the script used for analysis conducted for a level 5 statistics course report with title Peer relationships interact with cumulative trauma when mental health issues are in stake. 1.1 Introduction A second sensitive period of brain development, adolescence, is characterized by increased plasticity which is instrumental for adapting to challenges linked to this developmental phase (Lee et al., 2014). Unfortunately, this increased plasticity also leads to a greater susceptibility to negative effects which may be reflected in the emergence of mental illnesses at the beginning of adolescence (Lee et al., 2014). The prevalence of mental health issues in the adolescent population has been increasing over the past decade with current prevalence of depression symptoms at 17% (Keyes et al., 2019; Klasen et al., 2015). Furthermore, depression often co-occurs with anxiety (Melton et al., 2016) and PTSD symptoms (Andrews et al., 2015) in youth, which can lead to more severe consequences on adolescents’ lives and wellbeing (Melton et al., 2016). Trauma and cumulative life adversities during adolescence can have lasting effects on the functioning of the hypothalamic–pituitary–adrenal axis, which in turn affects mental health (Koss and Gunnar, 2018). Environmental adversities like living in poverty or experiencing food insecurity are detrimental to adolescents’ mental health (Ke and Ford-Jones, 2015; McIntyre et al., 2013; Romo et al., 2016; Slopen et al., 2010). Trauma like abuse, racial discrimination, or living with an adult suffering from alcohol use disorder further increase chances of developing a mental disorder in youth, especially in youth from disadvantaged backgrounds (Andrews et al., 2015; Jose and Cherayi, 2020; Myers et al., 2015; Raitasalo et al., 2019). However, a feeling of belonging to a community can alleviate some of the burden on mental health generated by food insecurity and other life adversities (Martin et al., 2016). Social support has positive effects on mental health of the adolescent population; it predicts less depressive symptoms, regardless of age, gender, or race (Klasen et al., 2015; Vaughan et al., 2010). Strong friendships predict more psychosocial resilience (Harmelen et al., 2017). A sense of connectedness to peers at school is also associated with better wellbeing and mental health (Moore et al., 2018). Furthermore, peer support lower social anxiety of adolescents who have been bullied (Coyle et al., 2021). To see if this pattern is generalizable to other childhood adversities, this study will test whether peer relationships mediate the effects of cumulative adversities in early life on mental health. "],["set-up.html", "2 Set Up 2.1 Importing and Wrangling of Data", " 2 Set Up library(here) library(tidyverse) library(ggplot2) library(cowplot) library(fitdistrplus) library(dplyr) library(broom) library(MASS) library(sjPlot) library(sjmisc) library(jtools) library(interactions) library(scico) library(ordinal) library(gghalves) library(patchwork) library(sure) library(countreg) library(ggeffects) library(effects) 2.1 Importing and Wrangling of Data Publicly available sample child interview datasets from years 2020 and 2019 were extracted from the Centers for Disease Control and Prevention website. The interviews are conducted on a yearly basis as a part of the National Health Interview Survey carried out by National Center for Health Statistics throughout the US. After filtering entries with missing values, the final sample size was 4,485 adolescents between age 10 and 17. The average age was 13.62 ⩲ 2.28 years SD. child_2020 &lt;- read_csv(&quot;child20.csv&quot;) ## Warning: 28 parsing failures. ## row col expected actual file ## 1146 INJMVTYPE5_C 1/0/T/F/TRUE/FALSE 2 &#39;child20.csv&#39; ## 1146 INJMVTYPE4_C 1/0/T/F/TRUE/FALSE 2 &#39;child20.csv&#39; ## 1146 INJMVTYPE3_C 1/0/T/F/TRUE/FALSE 2 &#39;child20.csv&#39; ## 1146 INJMVTYPE2_C 1/0/T/F/TRUE/FALSE 2 &#39;child20.csv&#39; ## 1480 INJMVTYPE4_C 1/0/T/F/TRUE/FALSE 2 &#39;child20.csv&#39; ## .... ............ .................. ...... ............. ## See problems(...) for more details. child_2019 &lt;- read_csv(&quot;child19.csv&quot;) ## Warning: 21 parsing failures. ## row col expected actual file ## 1171 PLNEXCHG2_C 1/0/T/F/TRUE/FALSE 9 &#39;child19.csv&#39; ## 1575 PLNEXCHG2_C 1/0/T/F/TRUE/FALSE 7 &#39;child19.csv&#39; ## 1639 PLNEXCHG2_C 1/0/T/F/TRUE/FALSE 2 &#39;child19.csv&#39; ## 2110 OPHDHP_C 1/0/T/F/TRUE/FALSE 2 &#39;child19.csv&#39; ## 2240 PLNEXCHG2_C 1/0/T/F/TRUE/FALSE 2 &#39;child19.csv&#39; ## .... ........... .................. ...... ............. ## See problems(...) for more details. Selecting the target columns and renaming them child_data &lt;- full_join(child_2019, child_2020) %&gt;% #joining data from 2019 and 2020 rename(age=AGEP_C, SDQ_peer = SDQPEER_C, SDQ_total = SDQTOT_C, violence=VIOLENEV_C, parent_jailed = JAILEV_C, MHI_home= MENTDEPEV_C, addict_home=ALCDRUGEV_C, food_security=FDSCAT4_C, poverty_ratio=RATCAT_C) %&gt;% dplyr::select(age, SDQ_peer, SDQ_total, violence, parent_jailed, MHI_home, addict_home, food_security, poverty_ratio) Filtering the dataset based on age (only 10yo and older) and calculating some new variables based on given information #getting rid of entries with NA values in crucial cols &amp; selecting only above 9 yo adolescents &lt;- child_data %&gt;% filter(!is.na(SDQ_peer)) %&gt;% #includes data about friendships filter(age &gt; 9) %&gt;% #selecting only adolescents (i.e. 10 and above) filter(SDQ_total &lt; 40) %&gt;% #max value of SDQ = 40 filter(SDQ_peer!=88) %&gt;% filter(food_security!=8) %&gt;% mutate(SDQ_30 = SDQ_total - SDQ_peer, poverty_recoded = ifelse(poverty_ratio&lt;6, (4-((poverty_ratio-1)*0.8)), 0), food_sec_recoded = (food_security-1)*1.33, violence = ifelse(violence==2, 0, 1), parent_jailed = ifelse(parent_jailed==2, 0, 1), MHI_home = ifelse(MHI_home==2, 0, 1), addict_home = ifelse(addict_home==2, 0, 1), early_life_stress = (violence + parent_jailed + MHI_home + addict_home), cumulative_trauma = (poverty_recoded + food_sec_recoded + early_life_stress), peer_problems = ifelse(SDQ_peer==0, &quot;none&quot;, ifelse(SDQ_peer &lt; 4, &quot;mild&quot;, ifelse(SDQ_peer &lt; 7, &quot;moderate&quot;, &quot;severe&quot;)))) %&gt;% relocate(age, SDQ_total, SDQ_30, SDQ_peer, peer_problems) sample_size &lt;- nrow(adolescents) print(sample_size) ## [1] 4485 "],["basic-data-summaries-and-explorations.html", "3 Basic Data Summaries and Explorations 3.1 Age Distribution 3.2 Exploring used variables and their distribution 3.3 First plotting of the data", " 3 Basic Data Summaries and Explorations summaries &lt;- adolescents %&gt;% group_by(SDQ_peer) %&gt;% summarise(n = n(), mean_30 = round(mean(as.numeric(SDQ_30)),3), sd_30 = round(sd(as.numeric(SDQ_30)),3), median_30=median(as.numeric(SDQ_30)), mean_ct = round(mean(cumulative_trauma), 3), sd_ct = round(sd(cumulative_trauma),3), median_ct = round(median(cumulative_trauma), 3)) summaries_overall &lt;- adolescents %&gt;% summarise(mean_30 = round(mean(as.numeric(SDQ_30)),3), sd_30 = round(sd(as.numeric(SDQ_30)),3), median_30=median(as.numeric(SDQ_30)), mean_ct = round(mean(cumulative_trauma), 3), sd_ct = round(sd(cumulative_trauma),3), median_ct = round(median(cumulative_trauma), 3), mean_PP = round(mean(as.numeric(SDQ_peer)),3), sd_PP = round(sd(as.numeric(SDQ_peer)),3), median_pp = round(median(SDQ_peer), 3)) write_csv(summaries, &quot;summary_table.csv&quot;) 3.1 Age Distribution age_graph &lt;- ggplot(adolescents, aes(x=age)) + geom_bar(fill=&quot;darksalmon&quot;) + theme_cowplot() + background_grid(major=&quot;y&quot;, minor=&quot;y&quot;) + scale_x_continuous(breaks = c(10,11,12,13,14,15,16,17)) + theme(legend.position = &quot;none&quot;, plot.title = element_text(size=12), axis.title = element_text(size=10)) + labs(x=&quot;Age&quot;, y=&quot;Count&quot;, title=&quot;Distribution of age&quot;) ggsave(&quot;age.png&quot;, plot=age_graph, units = &quot;cm&quot;, width = 11, height = 8.5, dpi = &quot;retina&quot;, device = &quot;png&quot;, path = here()) age_graph mean(adolescents$age) ## [1] 13.71996 sd(adolescents$age) ## [1] 2.279249 3.2 Exploring used variables and their distribution 3.2.1 SDQ 30 - depedent variable response_graph &lt;- ggplot(adolescents, aes(x=SDQ_30)) + geom_bar(fill=&quot;thistle&quot;) + theme_cowplot() + background_grid(major=&quot;y&quot;, minor=&quot;y&quot;) + theme(legend.position = &quot;none&quot;, plot.title = element_text(size=12), axis.title = element_text(size=10)) + labs(x=&quot;SDQ 30 score&quot;, y=&quot;Count&quot;, title=&quot;Distribution of response variable (SDQ 30 score)&quot;) SDQ_high_graph &lt;- ggplot(subset(adolescents, SDQ_30 &gt; 19), aes(x=SDQ_30)) + geom_bar(fill=&quot;thistle&quot;) + geom_text(data=subset(adolescents, SDQ_30 &gt; 22), stat=&#39;count&#39;, aes(label=..count..), vjust=-0.5, color=&quot;grey&quot;) + theme_cowplot() + background_grid(major=&quot;y&quot;, minor=&quot;y&quot;) + theme(legend.position = &quot;none&quot;, axis.title = element_blank(), axis.text = element_text(size=9), plot.background = element_rect(fill=&quot;white&quot;, size=0.8, color=&quot;gray&quot;, linetype=3)) + scale_x_continuous(breaks = c(20, 22, 24, 26, 28, 30)) + scale_y_continuous(breaks=c(0, 5, 10, 15)) response_graph &lt;- response_graph + inset_element(SDQ_high_graph, left = 0.5, bottom = 0.4, right = 1, top = 1) ggsave(&quot;response_graph .png&quot;, plot=response_graph, units = &quot;cm&quot;, width = 14, height = 10, dpi = &quot;retina&quot;, device = &quot;png&quot;, path = here()) response_graph 3.2.1.1 Fitting PDF fit_geom &lt;- fitdist(adolescents$SDQ_30, &quot;geom&quot;) plot(fit_geom) 3.2.2 Cumulative trauma - independent variable trauma_graph &lt;- ggplot(adolescents, aes(x=cumulative_trauma)) + geom_bar(fill=&quot;#CC6666&quot;, width=0.1) + theme_cowplot() + background_grid(major=&quot;y&quot;, minor=&quot;y&quot;) + theme(legend.position = &quot;none&quot;, plot.title = element_text(size=12, face=&quot;bold&quot;), axis.title = element_text(size=10)) + labs(x=&quot;Cumulative trauma&quot;, y=&quot;Count&quot;, title=&quot;Distribution of cumulative trauma across the sample&quot;) + scale_x_continuous(breaks = c(0,1,2,3,4,5,6,7,8,9,10,11)) high_trauma_graph&lt;- ggplot(subset(adolescents, cumulative_trauma &gt;= 5), aes(x=cumulative_trauma)) + geom_bar(fill=&quot;#CC6666&quot;, width=0.09) + theme_cowplot() + background_grid(major=&quot;y&quot;, minor=&quot;y&quot;) + theme(legend.position = &quot;none&quot;, axis.title = element_blank(), axis.text = element_text(size=9), plot.background = element_rect(fill=&quot;white&quot;, size=0.8, color=&quot;gray&quot;, linetype=3)) + scale_x_continuous(breaks = c(5, 6,7,8,9,10,11)) trauma_graph &lt;- trauma_graph + inset_element(high_trauma_graph, left = 0.5, bottom = 0.4, right = 1, top = 1) ggsave(&quot;trauma_graph.png&quot;, plot=trauma_graph, units = &quot;cm&quot;, width = 14, height = 10, dpi = &quot;retina&quot;, device = &quot;png&quot;, path = here()) ## Warning: position_stack requires non-overlapping x intervals ## Warning: position_stack requires non-overlapping x intervals trauma_graph ## Warning: position_stack requires non-overlapping x intervals ## Warning: position_stack requires non-overlapping x intervals trauma_graph_violin &lt;- ggplot(adolescents %&gt;% mutate(dummy=1), aes(x=dummy, y=cumulative_trauma)) + # violin plot geom_half_violin(aes(x=dummy+0.06), fill=&quot;#CC6666&quot;, alpha =0.9, color=NA, side = &quot;r&quot;) + # single subject data points (1 per participant) with horizontal jitter geom_point(aes(x=dummy-0.1), position = position_jitter(width =0.04, height = 0.1), shape=16, size = 1) + # boxplot of distribution (median, 1st and 3rd quartile) geom_boxplot(width = .08, outlier.shape = NA) + # adding plot of mean and SEM stat_summary(fun = mean, geom = &quot;point&quot;, size=1, shape = 16, position = position_nudge(+.06), colour = &quot;black&quot;) + stat_summary(fun.data = mean_se, geom = &quot;errorbar&quot;, position = position_nudge(+.06), colour = &quot;black&quot;, width = 1, size = 1) + # correcting labels labs(x = &#39;&#39;, y = &#39;Cumulative Trauma (0-12)&#39;, title = &#39;Distribution of cumulative trauma scores&#39;) + # aesthetical changes theme_cowplot() + theme(axis.text.y = element_blank(), axis.ticks.y = element_blank(), axis.title.x = element_text(size=11), axis.text.x = element_text(size=10), aspect.ratio = 1, plot.title = element_text(face=&quot;bold&quot;, size=12)) + scale_y_continuous(breaks = c(0,1,2,3,4,5,6,7,8,9,10,11, 12), limits = c(-0.2,12)) + scale_x_continuous(limits = c(0.85, 1.45)) + coord_flip() ggsave(&quot;trauma_graph_violin.png&quot;, plot=trauma_graph_violin, units = &quot;cm&quot;, width = 10, height = 10, dpi = &quot;retina&quot;, device = &quot;png&quot;, path = here()) trauma_graph_violin 3.2.3 Peer problems score peers_graph_overall &lt;- ggplot(adolescents, aes(x=SDQ_peer, fill=peer_problems)) + geom_bar(width=0.9, fill=c(&quot;#875F79&quot;)) + theme_cowplot() + background_grid(major=&quot;y&quot;, minor=&quot;y&quot;) + theme(legend.position = &quot;none&quot;, plot.title = element_text(size=12, vjust=6), axis.title = element_text(size=10)) + labs(x=&quot;Problems with peer relationships&quot;, y=&quot;Count&quot;, title=&quot;Distribution of SDQ Peer Problems Subscale Scores&quot;) + scale_x_continuous(breaks = c(0,1,2,3,4,5,6,7,8,9,10)) peers_graph_high &lt;- ggplot(subset(adolescents, SDQ_peer &gt; 4), aes(x=SDQ_peer)) + geom_bar(fill=&quot;#875F79&quot;, width=0.9) + geom_text(stat=&#39;count&#39;, aes(label=..count..), vjust=-0.8, color=&quot;grey&quot;) + theme_cowplot() + background_grid(major=&quot;y&quot;, minor=&quot;y&quot;) + theme(legend.position = &quot;none&quot;, plot.title = element_text(size=12), axis.title = element_text(size=10), axis.text = element_text(size=9), plot.background = element_rect(fill=&quot;white&quot;, size=0.8, color=&quot;gray&quot;, linetype=3)) + labs(x=&quot; &quot;, y=&quot; &quot;) + scale_x_continuous(breaks = c(5,6,7,8,9,10)) + scale_y_continuous(breaks=c(0, 20, 40, 60, 80)) peers_graph &lt;- peers_graph_overall + inset_element(peers_graph_high, left = 0.5, bottom = 0.4, right = 1, top = 1.05) ggsave(&quot;peer_graph.png&quot;, plot=peers_graph, units = &quot;cm&quot;, width = 14, height = 10, dpi = &quot;retina&quot;, device = &quot;png&quot;, path = here()) peers_graph 3.2.3.1 check for collinearity ggplot(adolescents, aes(x=as.numeric(SDQ_peer), y=cumulative_trauma)) + geom_jitter(width=0.4) + geom_smooth(stat = &quot;smooth&quot;, method=&quot;glm&quot;) ## `geom_smooth()` using formula &#39;y ~ x&#39; 3.3 First plotting of the data distribution &lt;- ggplot(adolescents, aes(x=cumulative_trauma, y=as.numeric(SDQ_30), color=as.factor(SDQ_peer))) + geom_jitter(width=0.3) + scale_color_scico_d(palette = &#39;batlow&#39;, begin=0, end=1) + theme_classic() + background_grid(minor = &quot;xy&quot;) + labs(x=&quot;Cumulative trauma&quot;, y=&quot;SDQ 30 score&quot;, title=&quot;Data&quot;, color=&quot;Peer problems&quot;) + theme(plot.title = element_text(size=12, face=&quot;bold&quot;), legend.position = &quot;none&quot;) + #guides(col = guide_legend(nrow = 1)) + scale_y_continuous(breaks=c(0, 5, 10, 15, 20, 25, 30)) + scale_x_continuous(breaks = c(0, 2, 4, 6, 8, 10, 12)) ggsave(&quot;data_graph.png&quot;, plot=distribution, units = &quot;cm&quot;, width = 15, height = 10.5, dpi = &quot;retina&quot;, device = &quot;png&quot;, path = here()) distribution distribution_facet &lt;- ggplot(adolescents, aes(x=cumulative_trauma, y=as.numeric(SDQ_30), color=as.factor(SDQ_peer))) + geom_jitter(width=0.3, size=0.65) + scale_color_scico_d(palette = &#39;batlow&#39;, begin=0, end=1) + theme_classic() + background_grid(minor = &quot;xy&quot;, size.major=0.2, size.minor=0.1) + labs(x=&quot;Cumulative trauma&quot;, y=&quot;SDQ 30 score&quot;, title=&quot;&quot;, color=&quot;Peer problems&quot;) + theme(plot.title = element_text(size=12, face=&quot;bold&quot;), legend.position = &quot;none&quot;) + #guides(col = guide_legend(nrow = 1)) + scale_y_continuous(breaks=c(0, 5, 10, 15, 20, 25, 30)) + scale_x_continuous(breaks = c(0, 2, 4, 6, 8, 10, 12)) + facet_wrap(~SDQ_peer, nrow = 2) + geom_smooth(method=glm, se=FALSE, color=&quot;red&quot;, size=0.5) ggsave(&quot;data_graph_facet.png&quot;, plot=distribution_facet, units = &quot;cm&quot;, width = 17, height = 7.5, dpi = &quot;retina&quot;, device = &quot;png&quot;, path = here()) ## `geom_smooth()` using formula &#39;y ~ x&#39; distribution_facet ## `geom_smooth()` using formula &#39;y ~ x&#39; "],["analysis.html", "4 Analysis 4.1 Poisson regression 4.2 Negative Binomial Model 4.3 Hurdle 4.4 CLM", " 4 Analysis 4.1 Poisson regression adolescents$SDQ_peer &lt;- as.factor(adolescents$SDQ_peer) interaction_model_poisson &lt;- glm(SDQ_30 ~ cumulative_trauma*SDQ_peer, data=adolescents, family=poisson(link=&quot;log&quot;)) poisson_summary &lt;- summary.glm(interaction_model_poisson) summ(interaction_model_poisson) ## MODEL INFO: ## Observations: 4485 ## Dependent Variable: SDQ_30 ## Type: Generalized linear model ## Family: poisson ## Link function: log ## ## MODEL FIT: ## χ²(21) = 5277.86, p = 0.00 ## Pseudo-R² (Cragg-Uhler) = 0.69 ## Pseudo-R² (McFadden) = 0.16 ## AIC = 26936.51, BIC = 27077.50 ## ## Standard errors: MLE ## ----------------------------------------------------------------- ## Est. S.E. z val. p ## ---------------------------------- ------- ------ -------- ------ ## (Intercept) 0.86 0.02 50.86 0.00 ## cumulative_trauma 0.08 0.01 11.66 0.00 ## SDQ_peer1 0.27 0.03 10.27 0.00 ## SDQ_peer2 0.51 0.03 18.33 0.00 ## SDQ_peer3 0.75 0.03 22.06 0.00 ## SDQ_peer4 1.05 0.04 29.23 0.00 ## SDQ_peer5 1.48 0.05 32.54 0.00 ## SDQ_peer6 1.61 0.06 28.46 0.00 ## SDQ_peer7 1.56 0.09 18.25 0.00 ## SDQ_peer8 1.93 0.16 11.95 0.00 ## SDQ_peer9 2.09 0.15 13.63 0.00 ## SDQ_peer10 1.79 0.18 9.92 0.00 ## cumulative_trauma:SDQ_peer1 0.01 0.01 1.32 0.19 ## cumulative_trauma:SDQ_peer2 0.01 0.01 1.31 0.19 ## cumulative_trauma:SDQ_peer3 0.01 0.01 1.00 0.32 ## cumulative_trauma:SDQ_peer4 -0.01 0.01 -1.26 0.21 ## cumulative_trauma:SDQ_peer5 -0.04 0.01 -2.93 0.00 ## cumulative_trauma:SDQ_peer6 -0.10 0.01 -6.66 0.00 ## cumulative_trauma:SDQ_peer7 -0.02 0.02 -1.42 0.16 ## cumulative_trauma:SDQ_peer8 -0.11 0.04 -3.02 0.00 ## cumulative_trauma:SDQ_peer9 -0.12 0.05 -2.59 0.01 ## cumulative_trauma:SDQ_peer10 -0.06 0.03 -2.06 0.04 ## ----------------------------------------------------------------- #checking on overdispersion dispersion_poisson &lt;- poisson_summary$deviance / poisson_summary$df.residual if (dispersion_poisson &gt; 2){ print(&quot;Overdispersion!&quot;) } else { print(&quot;You good on dispersion.&quot;) } ## [1] &quot;Overdispersion!&quot; 4.2 Negative Binomial Model fit_nbinom &lt;- fitdist(adolescents$SDQ_30, &quot;nbinom&quot;) plot(fit_nbinom) interaction_model_negbi &lt;- glm.nb(formula = SDQ_30 ~ cumulative_trauma * SDQ_peer, data = adolescents) nb_summary &lt;- summary(interaction_model_negbi) nb_summary ## ## Call: ## glm.nb(formula = SDQ_30 ~ cumulative_trauma * SDQ_peer, data = adolescents, ## init.theta = 1.344141107, link = log) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -2.5429 -1.0238 -0.2453 0.3778 2.7769 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) 0.856927 0.028484 30.085 &lt; 2e-16 *** ## cumulative_trauma 0.085567 0.013667 6.261 3.83e-10 *** ## SDQ_peer1 0.261057 0.046717 5.588 2.30e-08 *** ## SDQ_peer2 0.500779 0.052890 9.468 &lt; 2e-16 *** ## SDQ_peer3 0.747819 0.072048 10.379 &lt; 2e-16 *** ## SDQ_peer4 1.052307 0.084689 12.426 &lt; 2e-16 *** ## SDQ_peer5 1.485519 0.130774 11.359 &lt; 2e-16 *** ## SDQ_peer6 1.618485 0.170543 9.490 &lt; 2e-16 *** ## SDQ_peer7 1.569062 0.270354 5.804 6.49e-09 *** ## SDQ_peer8 1.952841 0.564844 3.457 0.000546 *** ## SDQ_peer9 2.088179 0.591936 3.528 0.000419 *** ## SDQ_peer10 1.790856 0.618733 2.894 0.003799 ** ## cumulative_trauma:SDQ_peer1 0.017591 0.020673 0.851 0.394817 ## cumulative_trauma:SDQ_peer2 0.014930 0.021108 0.707 0.479361 ## cumulative_trauma:SDQ_peer3 0.008245 0.024876 0.331 0.740294 ## cumulative_trauma:SDQ_peer4 -0.016170 0.027036 -0.598 0.549774 ## cumulative_trauma:SDQ_peer5 -0.040503 0.035679 -1.135 0.256283 ## cumulative_trauma:SDQ_peer6 -0.100564 0.040797 -2.465 0.013703 * ## cumulative_trauma:SDQ_peer7 -0.026008 0.053310 -0.488 0.625654 ## cumulative_trauma:SDQ_peer8 -0.113766 0.118016 -0.964 0.335052 ## cumulative_trauma:SDQ_peer9 -0.120232 0.173111 -0.695 0.487347 ## cumulative_trauma:SDQ_peer10 -0.061492 0.099607 -0.617 0.537003 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for Negative Binomial(1.3441) family taken to be 1) ## ## Null deviance: 6325.4 on 4484 degrees of freedom ## Residual deviance: 5185.5 on 4463 degrees of freedom ## AIC: 21821 ## ## Number of Fisher Scoring iterations: 1 ## ## ## Theta: 1.3441 ## Std. Err.: 0.0439 ## ## 2 x log-likelihood: -21775.4180 #checking for overdispersion dispersion_nb &lt;- nb_summary$deviance / nb_summary$df.residual if (dispersion_nb &gt; 2){ print(&quot;overdispersion!&quot;) } else { print(&quot;You good on dispersion.&quot;) } ## [1] &quot;You good on dispersion.&quot; #checking model fit hist(rstandard(interaction_model_negbi), main = &quot;Distribution of residuals&quot;, xlab=&quot;Residuals&quot;) plot(interaction_model_negbi,2) plot(rstandard(interaction_model_negbi),type=&quot;l&quot;) rootogram(interaction_model_negbi, max=30) #checking against reduced model control_model_negbi &lt;- glm.nb(SDQ_30 ~ cumulative_trauma+SDQ_peer, data=adolescents) #checking difference between the two models LL_interaction &lt;- logLik(interaction_model_negbi) LL_control &lt;- logLik(control_model_negbi) delta_2 &lt;- 2*(LL_interaction-LL_control) 1-pchisq(delta_2, 10) ## &#39;log Lik.&#39; 0.2824302 (df=23) #double check anova(interaction_model_negbi, control_model_negbi, test=&quot;LRT&quot;) ## Warning in anova.negbin(interaction_model_negbi, control_model_negbi, test = &quot;LRT&quot;): only Chi-squared ## LR tests are implemented ## Likelihood ratio tests of Negative Binomial Models ## ## Response: SDQ_30 ## Model theta Resid. df 2 x log-lik. Test df LR stat. Pr(Chi) ## 1 cumulative_trauma + SDQ_peer 1.336762 4473 -21787.46 ## 2 cumulative_trauma * SDQ_peer 1.344141 4463 -21775.42 1 vs 2 10 12.03937 0.2824302 #checking with each predictor #cumulative trauma only CT_model_negbi &lt;- glm.nb(SDQ_30 ~ cumulative_trauma, data=adolescents) #checking difference between the two models LL_var &lt;- logLik(CT_model_negbi) LL_control &lt;- logLik(control_model_negbi) delta_2 &lt;- 2*(LL_control-LL_var) 1-pchisq(delta_2, 10) ## &#39;log Lik.&#39; 0 (df=13) #double check anova(control_model_negbi, CT_model_negbi, test=&quot;LRT&quot;) ## Warning in anova.negbin(control_model_negbi, CT_model_negbi, test = &quot;LRT&quot;): only Chi-squared LR tests ## are implemented ## Likelihood ratio tests of Negative Binomial Models ## ## Response: SDQ_30 ## Model theta Resid. df 2 x log-lik. Test df LR stat. Pr(Chi) ## 1 cumulative_trauma 1.045221 4483 -22442.40 ## 2 cumulative_trauma + SDQ_peer 1.336762 4473 -21787.46 1 vs 2 10 654.9378 0 #peer problems only PP_model_negbi &lt;- glm.nb(SDQ_30 ~ SDQ_peer, data=adolescents) #checking difference between the two models LL_var &lt;- logLik(PP_model_negbi) LL_control &lt;- logLik(control_model_negbi) delta_2 &lt;- 2*(LL_control-LL_var) 1-pchisq(delta_2, 1) ## &#39;log Lik.&#39; 0 (df=13) #double check anova(control_model_negbi, PP_model_negbi, test=&quot;LRT&quot;) ## Warning in anova.negbin(control_model_negbi, PP_model_negbi, test = &quot;LRT&quot;): only Chi-squared LR tests ## are implemented ## Likelihood ratio tests of Negative Binomial Models ## ## Response: SDQ_30 ## Model theta Resid. df 2 x log-lik. Test df LR stat. Pr(Chi) ## 1 SDQ_peer 1.264198 4474 -21931.11 ## 2 cumulative_trauma + SDQ_peer 1.336762 4473 -21787.46 1 vs 2 1 143.6483 0 4.2.1 New reduced NB model hist(rstandard(control_model_negbi), main = &quot;Distribution of residuals&quot;, xlab=&quot;Residuals&quot;) plot(control_model_negbi,2) plot(rstandard(control_model_negbi),type=&quot;l&quot;) rootogram(control_model_negbi, max=30, main = &quot;Negative Binomial Model: Observed vs Fitted Values&quot;, xlab=&quot;SDQ 30&quot;) #playing with different summaries summary_negbi &lt;- summary(control_model_negbi) summary_negbi ## ## Call: ## glm.nb(formula = SDQ_30 ~ cumulative_trauma + SDQ_peer, data = adolescents, ## init.theta = 1.33676164, link = log) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -2.6038 -1.0401 -0.2651 0.4052 2.7706 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) 0.857251 0.025797 33.231 &lt; 2e-16 *** ## cumulative_trauma 0.085256 0.007147 11.928 &lt; 2e-16 *** ## SDQ_peer1 0.284552 0.039605 7.185 6.74e-13 *** ## SDQ_peer2 0.525502 0.043959 11.954 &lt; 2e-16 *** ## SDQ_peer3 0.764840 0.057464 13.310 &lt; 2e-16 *** ## SDQ_peer4 1.017132 0.065887 15.438 &lt; 2e-16 *** ## SDQ_peer5 1.386776 0.099072 13.998 &lt; 2e-16 *** ## SDQ_peer6 1.340942 0.122499 10.947 &lt; 2e-16 *** ## SDQ_peer7 1.469556 0.177306 8.288 &lt; 2e-16 *** ## SDQ_peer8 1.533308 0.320782 4.780 1.75e-06 *** ## SDQ_peer9 1.776825 0.340303 5.221 1.78e-07 *** ## SDQ_peer10 1.503870 0.369893 4.066 4.79e-05 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for Negative Binomial(1.3368) family taken to be 1) ## ## Null deviance: 6304.8 on 4484 degrees of freedom ## Residual deviance: 5181.8 on 4473 degrees of freedom ## AIC: 21813 ## ## Number of Fisher Scoring iterations: 1 ## ## ## Theta: 1.3368 ## Std. Err.: 0.0435 ## ## 2 x log-likelihood: -21787.4570 anova(control_model_negbi) ## Warning in anova.negbin(control_model_negbi): tests made without re-estimating &#39;theta&#39; ## Analysis of Deviance Table ## ## Model: Negative Binomial(1.3368), link: log ## ## Response: SDQ_30 ## ## Terms added sequentially (first to last) ## ## ## Df Deviance Resid. Df Resid. Dev Pr(&gt;Chi) ## NULL 4484 6304.8 ## cumulative_trauma 1 398.83 4483 5906.0 &lt; 2.2e-16 *** ## SDQ_peer 10 724.18 4473 5181.8 &lt; 2.2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 summ(control_model_negbi) ## MODEL INFO: ## Observations: 4485 ## Dependent Variable: SDQ_30 ## Type: Generalized linear model ## Family: Negative Binomial(1.3368) ## Link function: log ## ## MODEL FIT: ## χ²() = , p = ## Pseudo-R² (Cragg-Uhler) = 0.20 ## Pseudo-R² (McFadden) = 0.04 ## AIC = 21813.46, BIC = 21896.77 ## ## Standard errors: MLE ## ----------------------------------------------------- ## Est. S.E. z val. p ## ----------------------- ------ ------ -------- ------ ## (Intercept) 0.86 0.03 33.23 0.00 ## cumulative_trauma 0.09 0.01 11.93 0.00 ## SDQ_peer1 0.28 0.04 7.18 0.00 ## SDQ_peer2 0.53 0.04 11.95 0.00 ## SDQ_peer3 0.76 0.06 13.31 0.00 ## SDQ_peer4 1.02 0.07 15.44 0.00 ## SDQ_peer5 1.39 0.10 14.00 0.00 ## SDQ_peer6 1.34 0.12 10.95 0.00 ## SDQ_peer7 1.47 0.18 8.29 0.00 ## SDQ_peer8 1.53 0.32 4.78 0.00 ## SDQ_peer9 1.78 0.34 5.22 0.00 ## SDQ_peer10 1.50 0.37 4.07 0.00 ## ----------------------------------------------------- export_summs(control_model_negbi) ## Warning: Tidiers for objects of class negbin are not maintained by the broom team, and are only ## supported through the glm tidier method. Please be cautious in interpreting and reporting broom ## output. Table 4.1: Model 1 (Intercept)0.86 *** (0.03)&nbsp;&nbsp;&nbsp; cumulative_trauma0.09 *** (0.01)&nbsp;&nbsp;&nbsp; SDQ_peer10.28 *** (0.04)&nbsp;&nbsp;&nbsp; SDQ_peer20.53 *** (0.04)&nbsp;&nbsp;&nbsp; SDQ_peer30.76 *** (0.06)&nbsp;&nbsp;&nbsp; SDQ_peer41.02 *** (0.07)&nbsp;&nbsp;&nbsp; SDQ_peer51.39 *** (0.10)&nbsp;&nbsp;&nbsp; SDQ_peer61.34 *** (0.12)&nbsp;&nbsp;&nbsp; SDQ_peer71.47 *** (0.18)&nbsp;&nbsp;&nbsp; SDQ_peer81.53 *** (0.32)&nbsp;&nbsp;&nbsp; SDQ_peer91.78 *** (0.34)&nbsp;&nbsp;&nbsp; SDQ_peer101.50 *** (0.37)&nbsp;&nbsp;&nbsp; N4485&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AIC21813.46&nbsp;&nbsp;&nbsp;&nbsp; BIC21896.77&nbsp;&nbsp;&nbsp;&nbsp; Pseudo R20.20&nbsp;&nbsp;&nbsp;&nbsp; *** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05. summary(allEffects(control_model_negbi)) ## model: SDQ_30 ~ cumulative_trauma + SDQ_peer ## ## cumulative_trauma effect ## cumulative_trauma ## 0 3 6 8 10 ## 3.284668 4.241997 5.478343 6.496834 7.704676 ## ## Lower 95 Percent Confidence Limits ## cumulative_trauma ## 0 3 6 8 10 ## 3.168551 4.087494 5.104629 5.897549 6.807949 ## ## Upper 95 Percent Confidence Limits ## cumulative_trauma ## 0 3 6 8 10 ## 3.405040 4.402339 5.879416 7.157016 8.719517 ## ## SDQ_peer effect ## SDQ_peer ## 0 1 2 3 4 5 6 7 8 9 ## 2.644244 3.514639 4.472232 5.681555 7.312001 10.582076 10.108006 11.495331 12.252055 15.630282 ## 10 ## 11.896628 ## ## Lower 95 Percent Confidence Limits ## SDQ_peer ## 0 1 2 3 4 5 6 7 8 9 10 ## 2.518793 3.307984 4.165944 5.134478 6.490205 8.771582 7.993361 8.151591 6.546579 8.036194 5.772036 ## ## Upper 95 Percent Confidence Limits ## SDQ_peer ## 0 1 2 3 4 5 6 7 8 9 ## 2.775944 3.734205 4.801039 6.286923 8.237854 12.766265 12.782080 16.210656 22.929971 30.400672 ## 10 ## 24.519905 4.2.2 Plotting of the model predictions model_predict &lt;- data.frame(ggpredict(control_model_negbi, terms = c(&quot;cumulative_trauma&quot;, &quot;SDQ_peer&quot;))) model_graph &lt;- ggplot(model_predict, aes(x = x, y = predicted, colour = group, fill = group)) + # plotting the prediction geom_line(size = 0.75) + # plotting the confidence levels geom_ribbon(aes(ymin = conf.low, ymax = conf.high, xmin=0, xmax=12), alpha = .1, linetype=0) + # setting up color and fill palette - scico tokyo scale_color_scico_d(palette = &#39;batlow&#39;, begin=0, end=1) + scale_fill_scico_d(palette = &#39;batlow&#39;, begin=0, end=1) + # changing limits, breaks and labels of both axis scale_x_continuous(breaks = c(0,2,4,6,8,10,12), limits = c(0, 12)) + scale_y_continuous(breaks = c(0,10,20,30, 40, 50, 60, 70)) + # background setting theme_classic() + # changing labels and title labs(x=&quot;Cumulative trauma&quot;, title=&quot;Negative Binomial Model Predictions&quot;, color=&quot;Peer \\nproblems&quot;, fill=&quot;Peer \\nproblems&quot;) + theme(axis.text = element_text(size=11), axis.title = element_text(size=12), axis.title.y = element_blank(), legend.title = element_text( size=10), legend.text=element_text(size=10), legend.key.size = unit(0.5, &#39;cm&#39;), plot.title = element_text(size=12, face=&quot;bold&quot;)) + geom_hline(yintercept=30, size=0.5, linetype=2, alpha=0.5) model_graph ggsave(&quot;model_graph.png&quot;, plot=model_graph, units = &quot;cm&quot;, width = 15, height = 11, dpi = &quot;retina&quot;, device = &quot;png&quot;, path = here()) data_prediction &lt;- distribution + model_graph &amp; theme(plot.tag = element_text(size = 8), plot.title = element_text(size=12, face=&quot;italic&quot;)) &amp; plot_annotation(tag_levels = &#39;A&#39;, title=&quot;The effects of cumulative trauma and peer problems on SDQ 30 score&quot;, theme = theme(plot.title = element_text(size = 12, face=&quot;bold&quot;))) ggsave(&quot;data_prediction.png&quot;, plot=data_prediction, units = &quot;cm&quot;, width = 15, height = 8.5, dpi = &quot;retina&quot;, device = &quot;png&quot;, path = here()) data_prediction 4.3 Hurdle interaction_model_hurdle &lt;- hurdle(formula = SDQ_30 ~ cumulative_trauma * SDQ_peer, data = adolescents, dist =&quot;geometric&quot;) hurdle_summary &lt;- summary(interaction_model_hurdle) hurdle_summary ## ## Call: ## hurdle(formula = SDQ_30 ~ cumulative_trauma * SDQ_peer, data = adolescents, dist = &quot;geometric&quot;) ## ## Pearson residuals: ## Min 1Q Median 3Q Max ## -1.0348 -0.6768 -0.1980 0.3980 4.7273 ## ## Count model coefficients (truncated geometric with log link): ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) 0.918105 0.037995 24.164 &lt; 2e-16 *** ## cumulative_trauma 0.067707 0.017545 3.859 0.000114 *** ## SDQ_peer1 0.159597 0.060752 2.627 0.008613 ** ## SDQ_peer2 0.429727 0.067674 6.350 2.15e-10 *** ## SDQ_peer3 0.622528 0.088234 7.055 1.72e-12 *** ## SDQ_peer4 0.946328 0.102346 9.246 &lt; 2e-16 *** ## SDQ_peer5 1.325038 0.150027 8.832 &lt; 2e-16 *** ## SDQ_peer6 1.491574 0.201927 7.387 1.51e-13 *** ## SDQ_peer7 1.416996 0.310067 4.570 4.88e-06 *** ## SDQ_peer8 1.832499 0.698126 2.625 0.008668 ** ## SDQ_peer9 1.972574 0.666234 2.961 0.003069 ** ## SDQ_peer10 1.656514 0.709928 2.333 0.019630 * ## cumulative_trauma:SDQ_peer1 0.030684 0.026414 1.162 0.245382 ## cumulative_trauma:SDQ_peer2 0.017687 0.026373 0.671 0.502462 ## cumulative_trauma:SDQ_peer3 0.022493 0.030034 0.749 0.453909 ## cumulative_trauma:SDQ_peer4 -0.004587 0.032400 -0.142 0.887405 ## cumulative_trauma:SDQ_peer5 -0.014472 0.041219 -0.351 0.725520 ## cumulative_trauma:SDQ_peer6 -0.085251 0.049272 -1.730 0.083595 . ## cumulative_trauma:SDQ_peer7 -0.003872 0.061457 -0.063 0.949760 ## cumulative_trauma:SDQ_peer8 -0.098607 0.150179 -0.657 0.511440 ## cumulative_trauma:SDQ_peer9 -0.104305 0.192693 -0.541 0.588299 ## cumulative_trauma:SDQ_peer10 -0.042025 0.114432 -0.367 0.713431 ## Zero hurdle model coefficients (binomial with logit link): ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) 0.71197 0.05713 12.461 &lt; 2e-16 *** ## cumulative_trauma 0.13694 0.03374 4.058 4.95e-05 *** ## SDQ_peer1 0.52452 0.10554 4.970 6.69e-07 *** ## SDQ_peer2 0.64379 0.13030 4.941 7.77e-07 *** ## SDQ_peer3 1.21153 0.22942 5.281 1.29e-07 *** ## SDQ_peer4 1.47773 0.30964 4.772 1.82e-06 *** ## SDQ_peer5 4.98031 1.92053 2.593 0.00951 ** ## SDQ_peer6 3.20098 1.37222 2.333 0.01966 * ## SDQ_peer7 14.85410 709.82840 0.021 0.98330 ## SDQ_peer8 14.85410 1504.04801 0.010 0.99212 ## SDQ_peer9 14.85410 1588.82123 0.009 0.99254 ## SDQ_peer10 14.85410 1645.40372 0.009 0.99280 ## cumulative_trauma:SDQ_peer1 0.02236 0.05990 0.373 0.70895 ## cumulative_trauma:SDQ_peer2 0.13254 0.07636 1.736 0.08259 . ## cumulative_trauma:SDQ_peer3 0.11767 0.12010 0.980 0.32719 ## cumulative_trauma:SDQ_peer4 0.16288 0.16225 1.004 0.31544 ## cumulative_trauma:SDQ_peer5 -0.42831 0.28401 -1.508 0.13153 ## cumulative_trauma:SDQ_peer6 -0.08581 0.34979 -0.245 0.80621 ## cumulative_trauma:SDQ_peer7 -0.13694 137.33738 -0.001 0.99920 ## cumulative_trauma:SDQ_peer8 -0.13694 311.26397 0.000 0.99965 ## cumulative_trauma:SDQ_peer9 -0.13694 462.83439 0.000 0.99976 ## cumulative_trauma:SDQ_peer10 -0.13694 263.52271 -0.001 0.99959 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Number of iterations in BFGS optimization: 27 ## Log-likelihood: -1.089e+04 on 44 Df qqrplot(interaction_model_hurdle) rootogram(interaction_model_hurdle, max = 30) hist(interaction_model_hurdle$residuals) control_model_hurdle &lt;- hurdle(formula = SDQ_30 ~ cumulative_trauma + SDQ_peer, data = adolescents, dist =&quot;geometric&quot;) LL_int &lt;- logLik(interaction_model_hurdle) LL_control &lt;- logLik(control_model_hurdle) delta_2 &lt;- 2*(LL_int-LL_control) 1-pchisq(delta_2, 1) ## &#39;log Lik.&#39; 0.0001223055 (df=44) AIC(control_model_negbi, control_model_hurdle) ## df AIC ## control_model_negbi 13 21813.46 ## control_model_hurdle 24 21849.13 Hurdle model looks like a pretty good fit but residuals not really symmetrically distributed - still rightward skewed When tested against final NegBi model, it has higher AIC 4.4 CLM adolescents$SDQ_30 &lt;- as.ordered(adolescents$SDQ_30) clm_model &lt;- clm(SDQ_30 ~ cumulative_trauma*SDQ_peer, data=adolescents) summary(clm_model) ## formula: SDQ_30 ~ cumulative_trauma * SDQ_peer ## data: adolescents ## ## link threshold nobs logLik AIC niter max.grad cond.H ## logit flexible 4485 -10749.34 21594.67 6(0) 2.58e-07 1.4e+04 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## cumulative_trauma 0.13067 0.02380 5.489 4.03e-08 *** ## SDQ_peer1 0.43268 0.07817 5.535 3.11e-08 *** ## SDQ_peer2 0.79009 0.09234 8.556 &lt; 2e-16 *** ## SDQ_peer3 1.24999 0.12959 9.646 &lt; 2e-16 *** ## SDQ_peer4 1.90008 0.16215 11.718 &lt; 2e-16 *** ## SDQ_peer5 3.37032 0.26875 12.541 &lt; 2e-16 *** ## SDQ_peer6 3.73450 0.32229 11.588 &lt; 2e-16 *** ## SDQ_peer7 3.53776 0.51997 6.804 1.02e-11 *** ## SDQ_peer8 5.45650 1.04254 5.234 1.66e-07 *** ## SDQ_peer9 6.07487 0.97562 6.227 4.77e-10 *** ## SDQ_peer10 4.46953 1.08764 4.109 3.97e-05 *** ## cumulative_trauma:SDQ_peer1 0.04599 0.03670 1.253 0.2102 ## cumulative_trauma:SDQ_peer2 0.08873 0.03803 2.333 0.0197 * ## cumulative_trauma:SDQ_peer3 0.11842 0.04579 2.586 0.0097 ** ## cumulative_trauma:SDQ_peer4 0.09577 0.05106 1.876 0.0607 . ## cumulative_trauma:SDQ_peer5 0.03778 0.07192 0.525 0.5994 ## cumulative_trauma:SDQ_peer6 -0.18731 0.07726 -2.424 0.0153 * ## cumulative_trauma:SDQ_peer7 0.17528 0.10183 1.721 0.0852 . ## cumulative_trauma:SDQ_peer8 -0.31553 0.20714 -1.523 0.1277 ## cumulative_trauma:SDQ_peer9 -0.33545 0.28799 -1.165 0.2441 ## cumulative_trauma:SDQ_peer10 -0.06658 0.20391 -0.327 0.7440 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Threshold coefficients: ## Estimate Std. Error z value ## 0|1 -0.71521 0.05106 -14.006 ## 1|2 0.05663 0.04920 1.151 ## 2|3 0.64337 0.05010 12.842 ## 3|4 1.10874 0.05194 21.348 ## 4|5 1.49100 0.05408 27.571 ## 5|6 1.86979 0.05677 32.937 ## 6|7 2.20111 0.05964 36.906 ## 7|8 2.52194 0.06289 40.101 ## 8|9 2.76862 0.06577 42.098 ## 9|10 3.03101 0.06927 43.756 ## 10|11 3.38221 0.07470 45.276 ## 11|12 3.64210 0.07930 45.925 ## 12|13 3.91292 0.08466 46.220 ## 13|14 4.25454 0.09231 46.087 ## 14|15 4.56816 0.10048 45.462 ## 15|16 4.90433 0.11073 44.289 ## 16|17 5.23952 0.12272 42.694 ## 17|18 5.59097 0.13725 40.735 ## 18|19 5.87450 0.15086 38.939 ## 19|20 6.08469 0.16228 37.495 ## 20|21 6.46849 0.18621 34.739 ## 21|22 6.90550 0.21975 31.425 ## 22|23 7.55545 0.28689 26.336 ## 23|24 8.43573 0.42309 19.939 ## 24|27 8.85347 0.51265 17.270 ## 27|28 9.14591 0.58839 15.544 ## 28|29 10.25391 1.00649 10.188 anova(clm_model) ## Type I Analysis of Deviance Table with Wald chi-square tests ## ## Df Chisq Pr(&gt;Chisq) ## cumulative_trauma 1 435.123 &lt; 2.2e-16 *** ## SDQ_peer 10 797.826 &lt; 2.2e-16 *** ## cumulative_trauma:SDQ_peer 10 27.049 0.002559 ** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 scale_test(clm_model) ## Tests of scale effects ## ## formula: SDQ_30 ~ cumulative_trauma * SDQ_peer ## Df logLik AIC LRT Pr(&gt;Chi) ## &lt;none&gt; -10749 21595 ## cumulative_trauma 1 -10745 21588 8.239 0.0041004 ** ## SDQ_peer 10 -10733 21582 33.006 0.0002718 *** ## cumulative_trauma:SDQ_peer 11 -10738 21594 22.352 0.0217861 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 clm_model_control &lt;- clm(SDQ_30 ~ cumulative_trauma+SDQ_peer, data=adolescents) LL_interaction &lt;- logLik(clm_model) LL_control &lt;- logLik(clm_model_control) delta_2 &lt;- 2*(LL_interaction-LL_control) 1-pchisq(delta_2, 10) ## &#39;log Lik.&#39; 0.00335421 (df=48) anova(clm_model_control, clm_model, test=&quot;Chisq&quot;) ## &#39;test&#39; argument ignored in anova.clm ## Likelihood ratio tests of cumulative link models: ## ## formula: link: threshold: ## clm_model_control SDQ_30 ~ cumulative_trauma + SDQ_peer logit flexible ## clm_model SDQ_30 ~ cumulative_trauma * SDQ_peer logit flexible ## ## no.par AIC logLik LR.stat df Pr(&gt;Chisq) ## clm_model_control 38 21601 -10762 ## clm_model 48 21595 -10749 26.302 10 0.003354 ** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 4.4.1 Plotting of the final model new_data &lt;- data.frame(&quot;cumulative_trauma&quot;=c(0:12), &quot;SDQ_peer&quot;=as.factor(0)) predicted &lt;- data.frame(predict(clm_model,new_data,type = &quot;p&quot;)) %&gt;% mutate(cumulative_trauma=c(0:12), SDQ_peer=as.factor(0)) for (i in 1:10) { new_data &lt;- data.frame(&quot;cumulative_trauma&quot;=c(0:12), &quot;SDQ_peer&quot;=as.factor(i)) predicted_new &lt;- data.frame(predict(clm_model,new_data,type = &quot;p&quot;)) %&gt;% mutate(cumulative_trauma=c(0:12), SDQ_peer=as.factor(i)) predicted &lt;- full_join(predicted, predicted_new) } ## Joining, by = c(&quot;fit.0&quot;, &quot;fit.1&quot;, &quot;fit.2&quot;, &quot;fit.3&quot;, &quot;fit.4&quot;, &quot;fit.5&quot;, &quot;fit.6&quot;, &quot;fit.7&quot;, &quot;fit.8&quot;, &quot;fit.9&quot;, &quot;fit.10&quot;, &quot;fit.11&quot;, &quot;fit.12&quot;, &quot;fit.13&quot;, &quot;fit.14&quot;, &quot;fit.15&quot;, &quot;fit.16&quot;, &quot;fit.17&quot;, &quot;fit.18&quot;, &quot;fit.19&quot;, &quot;fit.20&quot;, &quot;fit.21&quot;, &quot;fit.22&quot;, &quot;fit.23&quot;, &quot;fit.24&quot;, &quot;fit.27&quot;, &quot;fit.28&quot;, &quot;fit.29&quot;, &quot;cumulative_trauma&quot;, &quot;SDQ_peer&quot;) ## Joining, by = c(&quot;fit.0&quot;, &quot;fit.1&quot;, &quot;fit.2&quot;, &quot;fit.3&quot;, &quot;fit.4&quot;, &quot;fit.5&quot;, &quot;fit.6&quot;, &quot;fit.7&quot;, &quot;fit.8&quot;, &quot;fit.9&quot;, &quot;fit.10&quot;, &quot;fit.11&quot;, &quot;fit.12&quot;, &quot;fit.13&quot;, &quot;fit.14&quot;, &quot;fit.15&quot;, &quot;fit.16&quot;, &quot;fit.17&quot;, &quot;fit.18&quot;, &quot;fit.19&quot;, &quot;fit.20&quot;, &quot;fit.21&quot;, &quot;fit.22&quot;, &quot;fit.23&quot;, &quot;fit.24&quot;, &quot;fit.27&quot;, &quot;fit.28&quot;, &quot;fit.29&quot;, &quot;cumulative_trauma&quot;, &quot;SDQ_peer&quot;) ## Joining, by = c(&quot;fit.0&quot;, &quot;fit.1&quot;, &quot;fit.2&quot;, &quot;fit.3&quot;, &quot;fit.4&quot;, &quot;fit.5&quot;, &quot;fit.6&quot;, &quot;fit.7&quot;, &quot;fit.8&quot;, &quot;fit.9&quot;, &quot;fit.10&quot;, &quot;fit.11&quot;, &quot;fit.12&quot;, &quot;fit.13&quot;, &quot;fit.14&quot;, &quot;fit.15&quot;, &quot;fit.16&quot;, &quot;fit.17&quot;, &quot;fit.18&quot;, &quot;fit.19&quot;, &quot;fit.20&quot;, &quot;fit.21&quot;, &quot;fit.22&quot;, &quot;fit.23&quot;, &quot;fit.24&quot;, &quot;fit.27&quot;, &quot;fit.28&quot;, &quot;fit.29&quot;, &quot;cumulative_trauma&quot;, &quot;SDQ_peer&quot;) ## Joining, by = c(&quot;fit.0&quot;, &quot;fit.1&quot;, &quot;fit.2&quot;, &quot;fit.3&quot;, &quot;fit.4&quot;, &quot;fit.5&quot;, &quot;fit.6&quot;, &quot;fit.7&quot;, &quot;fit.8&quot;, &quot;fit.9&quot;, &quot;fit.10&quot;, &quot;fit.11&quot;, &quot;fit.12&quot;, &quot;fit.13&quot;, &quot;fit.14&quot;, &quot;fit.15&quot;, &quot;fit.16&quot;, &quot;fit.17&quot;, &quot;fit.18&quot;, &quot;fit.19&quot;, &quot;fit.20&quot;, &quot;fit.21&quot;, &quot;fit.22&quot;, &quot;fit.23&quot;, &quot;fit.24&quot;, &quot;fit.27&quot;, &quot;fit.28&quot;, &quot;fit.29&quot;, &quot;cumulative_trauma&quot;, &quot;SDQ_peer&quot;) ## Joining, by = c(&quot;fit.0&quot;, &quot;fit.1&quot;, &quot;fit.2&quot;, &quot;fit.3&quot;, &quot;fit.4&quot;, &quot;fit.5&quot;, &quot;fit.6&quot;, &quot;fit.7&quot;, &quot;fit.8&quot;, &quot;fit.9&quot;, &quot;fit.10&quot;, &quot;fit.11&quot;, &quot;fit.12&quot;, &quot;fit.13&quot;, &quot;fit.14&quot;, &quot;fit.15&quot;, &quot;fit.16&quot;, &quot;fit.17&quot;, &quot;fit.18&quot;, &quot;fit.19&quot;, &quot;fit.20&quot;, &quot;fit.21&quot;, &quot;fit.22&quot;, &quot;fit.23&quot;, &quot;fit.24&quot;, &quot;fit.27&quot;, &quot;fit.28&quot;, &quot;fit.29&quot;, &quot;cumulative_trauma&quot;, &quot;SDQ_peer&quot;) ## Joining, by = c(&quot;fit.0&quot;, &quot;fit.1&quot;, &quot;fit.2&quot;, &quot;fit.3&quot;, &quot;fit.4&quot;, &quot;fit.5&quot;, &quot;fit.6&quot;, &quot;fit.7&quot;, &quot;fit.8&quot;, &quot;fit.9&quot;, &quot;fit.10&quot;, &quot;fit.11&quot;, &quot;fit.12&quot;, &quot;fit.13&quot;, &quot;fit.14&quot;, &quot;fit.15&quot;, &quot;fit.16&quot;, &quot;fit.17&quot;, &quot;fit.18&quot;, &quot;fit.19&quot;, &quot;fit.20&quot;, &quot;fit.21&quot;, &quot;fit.22&quot;, &quot;fit.23&quot;, &quot;fit.24&quot;, &quot;fit.27&quot;, &quot;fit.28&quot;, &quot;fit.29&quot;, &quot;cumulative_trauma&quot;, &quot;SDQ_peer&quot;) ## Joining, by = c(&quot;fit.0&quot;, &quot;fit.1&quot;, &quot;fit.2&quot;, &quot;fit.3&quot;, &quot;fit.4&quot;, &quot;fit.5&quot;, &quot;fit.6&quot;, &quot;fit.7&quot;, &quot;fit.8&quot;, &quot;fit.9&quot;, &quot;fit.10&quot;, &quot;fit.11&quot;, &quot;fit.12&quot;, &quot;fit.13&quot;, &quot;fit.14&quot;, &quot;fit.15&quot;, &quot;fit.16&quot;, &quot;fit.17&quot;, &quot;fit.18&quot;, &quot;fit.19&quot;, &quot;fit.20&quot;, &quot;fit.21&quot;, &quot;fit.22&quot;, &quot;fit.23&quot;, &quot;fit.24&quot;, &quot;fit.27&quot;, &quot;fit.28&quot;, &quot;fit.29&quot;, &quot;cumulative_trauma&quot;, &quot;SDQ_peer&quot;) ## Joining, by = c(&quot;fit.0&quot;, &quot;fit.1&quot;, &quot;fit.2&quot;, &quot;fit.3&quot;, &quot;fit.4&quot;, &quot;fit.5&quot;, &quot;fit.6&quot;, &quot;fit.7&quot;, &quot;fit.8&quot;, &quot;fit.9&quot;, &quot;fit.10&quot;, &quot;fit.11&quot;, &quot;fit.12&quot;, &quot;fit.13&quot;, &quot;fit.14&quot;, &quot;fit.15&quot;, &quot;fit.16&quot;, &quot;fit.17&quot;, &quot;fit.18&quot;, &quot;fit.19&quot;, &quot;fit.20&quot;, &quot;fit.21&quot;, &quot;fit.22&quot;, &quot;fit.23&quot;, &quot;fit.24&quot;, &quot;fit.27&quot;, &quot;fit.28&quot;, &quot;fit.29&quot;, &quot;cumulative_trauma&quot;, &quot;SDQ_peer&quot;) ## Joining, by = c(&quot;fit.0&quot;, &quot;fit.1&quot;, &quot;fit.2&quot;, &quot;fit.3&quot;, &quot;fit.4&quot;, &quot;fit.5&quot;, &quot;fit.6&quot;, &quot;fit.7&quot;, &quot;fit.8&quot;, &quot;fit.9&quot;, &quot;fit.10&quot;, &quot;fit.11&quot;, &quot;fit.12&quot;, &quot;fit.13&quot;, &quot;fit.14&quot;, &quot;fit.15&quot;, &quot;fit.16&quot;, &quot;fit.17&quot;, &quot;fit.18&quot;, &quot;fit.19&quot;, &quot;fit.20&quot;, &quot;fit.21&quot;, &quot;fit.22&quot;, &quot;fit.23&quot;, &quot;fit.24&quot;, &quot;fit.27&quot;, &quot;fit.28&quot;, &quot;fit.29&quot;, &quot;cumulative_trauma&quot;, &quot;SDQ_peer&quot;) ## Joining, by = c(&quot;fit.0&quot;, &quot;fit.1&quot;, &quot;fit.2&quot;, &quot;fit.3&quot;, &quot;fit.4&quot;, &quot;fit.5&quot;, &quot;fit.6&quot;, &quot;fit.7&quot;, &quot;fit.8&quot;, &quot;fit.9&quot;, &quot;fit.10&quot;, &quot;fit.11&quot;, &quot;fit.12&quot;, &quot;fit.13&quot;, &quot;fit.14&quot;, &quot;fit.15&quot;, &quot;fit.16&quot;, &quot;fit.17&quot;, &quot;fit.18&quot;, &quot;fit.19&quot;, &quot;fit.20&quot;, &quot;fit.21&quot;, &quot;fit.22&quot;, &quot;fit.23&quot;, &quot;fit.24&quot;, &quot;fit.27&quot;, &quot;fit.28&quot;, &quot;fit.29&quot;, &quot;cumulative_trauma&quot;, &quot;SDQ_peer&quot;) predicted &lt;- predicted %&gt;% relocate(cumulative_trauma, SDQ_peer) %&gt;% rename_with(~ gsub(&quot;fit.&quot;, &quot;SDQ_&quot;, .x, fixed = TRUE)) %&gt;% pivot_longer(cols = SDQ_0:SDQ_29, names_to = &quot;SDQ_30&quot;, values_to = &quot;probability&quot;) %&gt;% mutate(probability = probability*100) predicted$SDQ_30 &lt;- factor(predicted$SDQ_30, levels = c(&quot;SDQ_0&quot;, &quot;SDQ_1&quot;, &quot;SDQ_2&quot;, &quot;SDQ_3&quot;, &quot;SDQ_4&quot;, &quot;SDQ_5&quot;, &quot;SDQ_6&quot;, &quot;SDQ_7&quot;, &quot;SDQ_8&quot;, &quot;SDQ_9&quot;, &quot;SDQ_10&quot;, &quot;SDQ_11&quot;, &quot;SDQ_12&quot;, &quot;SDQ_13&quot;, &quot;SDQ_14&quot;, &quot;SDQ_15&quot;, &quot;SDQ_16&quot;, &quot;SDQ_17&quot;, &quot;SDQ_18&quot;, &quot;SDQ_19&quot;, &quot;SDQ_20&quot;, &quot;SDQ_21&quot;, &quot;SDQ_22&quot;, &quot;SDQ_23&quot;, &quot;SDQ_24&quot;, &quot;SDQ_25&quot;, &quot;SDQ_26&quot;, &quot;SDQ_27&quot;, &quot;SDQ_28&quot;, &quot;SDQ_29&quot;)) probabilities &lt;- ggplot(predicted, aes(x=cumulative_trauma, y=probability, fill=SDQ_peer)) + geom_area() + theme_classic() + scale_x_continuous(breaks = c(0,4,8,12)) + scale_fill_scico_d(palette = &#39;batlow&#39;, begin=0, end=1) + facet_wrap(.~ordered(SDQ_30), ncol = 7) + labs(x = &quot;Cumulative trauma&quot;, y=&quot;Probability&quot;, fill=&quot;Peer \\nproblems&quot;) + theme(legend.title = element_text(size=10), legend.text=element_text(size=8), legend.key.size = unit(0.4, &#39;cm&#39;)) ggsave(&quot;probabilities.png&quot;, plot=probabilities, units = &quot;cm&quot;, width = 25, height = 15.5, dpi = &quot;retina&quot;, device = &quot;png&quot;, path = here()) ggplot(predicted, aes(x=cumulative_trauma, y=probability, color=SDQ_peer, fill=SDQ_peer)) + geom_line() + theme_classic() + scale_x_continuous(breaks = c(0,4,8,12)) + scale_color_scico_d(palette = &#39;batlow&#39;, begin=0, end=1) + scale_fill_scico_d(palette = &#39;batlow&#39;, begin=0, end=1) + facet_wrap(.~ordered(SDQ_30)) + labs(x = &quot;Cumulative trauma&quot;, y=&quot;Probability&quot;) #model fit hist(resids(clm_model), main = &quot;Distribution of residuals&quot;, xlab=&quot;Residuals&quot;) autoplot.clm(clm_model, what = &quot;qq&quot;) + theme_bw() + labs(title = &quot;Normal Q-Q&quot;) + theme(plot.title = element_text(hjust = 0.5, face = &quot;bold&quot;)) plot(resids(clm_model),type=&quot;l&quot;) #alternative plotting plot_model(clm_model, type=&quot;int&quot;, colors = scico(11, palette = &quot;batlow&quot;)) + scale_x_continuous(breaks=c(0,4,8,12)) + theme(axis.text = element_text(size = 8), axis.title.y = element_blank()) + labs(legend = &quot;Peer \\nproblems&quot;, x=&quot;Cumulative Trauma (0-12)&quot;, title = &quot;Predicted probabilities of SDQ 30&quot;) plot_model(clm_model, terms=&quot;cumulative_trauma&quot;, type=&quot;eff&quot;) + scale_x_continuous(breaks = c(0,2,4,6,8,10,12)) + labs(x=&quot;Cumulative Trauma (0-12)&quot;) + theme(axis.title.y = element_blank()) "]]
